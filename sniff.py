from scapy.all import *

command = input()

command = command.split()

if (command[0]!="sniff" and command[0]!="syn_flood"):
    print(f"Command '{command[0]}' not found.")
    # continue

# CHECK command[0] IS sniff or SYN_Flood HERE!

command.remove(command[0])

if(len(command) != 0 and str(command[0]).startswith("-")):
    options=list(str(command[0]))
    options.remove("-")
    args = command[1:]

    protocol_options=[]
    if 'T' in options:
        protocol_options.append("T")
        options.remove("T")
    if 'U' in options:
        protocol_options.append("U")
        options.remove("U")
    if 'I' in options:
        protocol_options.append("I")
        options.remove("I")
    #print("Options: " + str(options))
    #print("Protocol options: " + str(protocol_options))
    #print("Arguments: " + str(args))

    op_arg = {}

    if(len(args)!=len(options)):
        print("Missing arguments for amount of options that you have entered.")
        # return 0
    
    for i in range(len(args)):
        op_arg[options[i]]=args[i]
    # print("Options for arguments: " + str(op_arg))

    fltr=""

    if("s" in options):
        fltr = fltr + "src " + op_arg["s"] + " "
    
    if("d" in options):
        fltr = fltr + "dst " + op_arg["d"] + " "
    
    if("p" in options):
        fltr = fltr + "port " + op_arg["p"]  

    if(protocol_options!=[]):
        if 'T' in options:
            fltr = fltr + " "
        if 'U' in options:
            protocol_options.append("U")
            options.remove("U")
        if 'I' in options:
            protocol_options.append("I")
            options.remove("I")
    
    if(fltr==""):
        if("c" in options):
            capture = sniff(count=int(op_arg["c"]))
            capture.summary()   
        else:
            capture = sniff()
            capture.summary()

    else:
        if("c" in options):
            print(fltr)
            capture = sniff(count=int(op_arg["c"]), filter=fltr)
            capture.summary()
        
        else:
            capture = sniff(filter=fltr)
            capture.summary()

else:
    print("Please enter a valid option.")

# dst port 80
# dst 192.168.1.1
# udp tcp icmp
# and or

#capture = sniff(count=1, filter = 'src 192.168.1.1 and udp')

#capture.summary()
